# Story 2.1: ai-catalog-user

## Status
Approved

## Story
**As a** teacher who has completed the mandatory training course,
**I want** to browse, search, and access a curated catalog of AI tools relevant to my teaching subjects,
**so that** I can effectively integrate approved AI services into my educational workflow

## Acceptance Criteria
1. Каталог доступен только учителям с завершенным обучающим курсом
2. Интерфейс каталога реализован согласно front-end-spec (кнопка "Назад", заголовок, панель инструментов, сетка карточек)
3. Панель инструментов содержит поиск по названию и описанию сервисов
4. Фильтр по предметам позволяет отбирать сервисы по учебным дисциплинам
5. Сетка карточек отображает все доступные AI сервисы с основной информацией
6. Каждая карточка содержит: название, краткое описание, предметы, рейтинг, ссылку доступа
7. Поиск работает в реальном времени с подсветкой результатов
8. Фильтры сохраняются при навигации (URL state management)
9. Карточки кликабельны и ведут к детальной информации о сервисе
10. Пустое состояние показывается когда нет результатов поиска/фильтрации
11. Loading состояния при загрузке данных каталога
12. Responsive design для просмотра на планшете и мобильном устройстве

## Tasks / Subtasks
- [ ] Access control и authorization (AC: 1)
  - [ ] Проверка завершения курса перед доступом
  - [ ] Redirect незавершенных пользователей в learning center
  - [ ] Course completion status в navigation header
  - [ ] Proper error messaging для restricted access

- [ ] Основной интерфейс каталога (AC: 2, 11)
  - [ ] Создать layout согласно front-end-spec
  - [ ] Реализовать кнопку "Назад" в главный хаб
  - [ ] Добавить заголовок страницы и breadcrumbs
  - [ ] Создать loading скелетоны для карточек

- [ ] Поиск и фильтрация (AC: 3, 4, 7, 8)
  - [ ] Реализовать search input с debouncing
  - [ ] Создать subject filter dropdown/checkboxes
  - [ ] Добавить real-time поиск с highlighting
  - [ ] Сохранение фильтров в URL params

- [ ] Сетка карточек сервисов (AC: 5, 6, 9)
  - [ ] Создать ServiceCard компонент
  - [ ] Отобразить название, описание, предметы
  - [ ] Добавить rating display и access link
  - [ ] Реализовать клик для детального просмотра

- [ ] States и UX (AC: 10, 12)
  - [ ] Empty state для "нет результатов"
  - [ ] Empty state для "нет сервисов"
  - [ ] Responsive grid layout
  - [ ] Mobile-friendly touch targets

- [ ] Интеграция с данными (требуется для всех AC)
  - [ ] Fetch ServiceCatalogEntry данные
  - [ ] Subject taxonomy integration
  - [ ] Search indexing и optimization
  - [ ] Cache strategy для catalog data

## Dev Notes

### Архитектурный контекст
- **Data Source:** ServiceCatalogEntry table из architecture.md
- **Access Control:** Интеграция с UserCourseProgress для проверки completion
- **UI Framework:** Radix UI search, filters + custom grid layout
- **State Management:** React Query для catalog data, URL state для filters

### UI/UX Requirements из front-end-spec.md
#### Каталог сервисов (Сценарий 2, п.2):
- **Layout:** Кнопка "Назад", заголовок, панель инструментов, сетка карточек
- **Панель инструментов:** Поиск + фильтр по предметам
- **Сетка:** Responsive карточки сервисов
- **Navigation:** SPA transitions без перезагрузки

### Database Schema
ServiceCatalogEntry fields (предполагаемые):
- `name` - название сервиса
- `description` - описание функциональности
- `subjects` - массив предметов (JSON/relation)
- `rating` - пользовательский рейтинг
- `access_url` - ссылка на сервис
- `category` - категория инструмента
- `is_active` - статус активности

### Technical Implementation
#### Search Strategy:
```javascript
// Client-side search для MVP
const useServiceSearch = (query, filters) => {
  return useMemo(() => {
    return services.filter(service => 
      service.name.toLowerCase().includes(query.toLowerCase()) ||
      service.description.toLowerCase().includes(query.toLowerCase())
    ).filter(service => 
      filters.subjects.length === 0 || 
      service.subjects.some(s => filters.subjects.includes(s))
    );
  }, [services, query, filters]);
};
```

#### URL State Management:
- `/catalog?search=query&subjects=math,science`
- Persistence при back/forward navigation
- Deep linking support

### Subject Taxonomy
Предполагаемые предметы (расширяемо):
- Математика
- Физика  
- Химия
- Биология
- История
- Литература
- Иностранные языки
- Информатика

### Dependencies
- `use-debounce` - search input debouncing
- `@radix-ui/react-select` - subject filters
- Custom search highlighting utility

### Performance Considerations
- Virtual scrolling для больших каталогов (future)
- Image lazy loading для service icons
- Search debouncing (300ms)
- Memoized filter computations

### Testing

#### Catalog-Specific Testing Requirements
- Access control: 100% coverage (критично)
- Search functionality: все edge cases
- Filter combinations: comprehensive testing
- URL state persistence: все scenarios

#### Key Test Scenarios
- Course completion requirement enforcement
- Search with various queries (empty, special chars, long)
- Filter combinations и reset
- Empty states и loading states
- Mobile responsiveness

#### E2E Catalog Flow:
```javascript
test('Complete AI catalog user journey', async ({ page }) => {
  // 1. Login as completed user
  // 2. Navigate to catalog from main hub
  // 3. Search for specific AI tool
  // 4. Apply subject filters
  // 5. Click on service card
  // 6. Verify URL state persistence
  // 7. Test back navigation
});

test('Access control enforcement', async ({ page }) => {
  // 1. Login as incomplete user
  // 2. Try direct navigation to /catalog
  // 3. Verify redirect to learning center
  // 4. Complete course
  // 5. Verify catalog access granted
});
```

#### Search Testing Strategy
- Exact matches
- Partial matches
- Case insensitive
- Special characters
- No results scenarios
- Performance с большими datasets

## Change Log
| Date | Version | Description | Author |
|------|---------|-------------|---------|
| 2025-07-25 | 1.0 | Initial story creation for AI catalog user interface | Sarah (PO) |

## Dev Agent Record
_(This section is populated by the development agent during implementation)_

### Agent Model Used
_(Заполняется dev-agent)_

### Debug Log References
_(Заполняется dev-agent)_

### Completion Notes List
_(Заполняется dev-agent)_

### File List
_(Заполняется dev-agent)_

## QA Results
_(Results from QA Agent QA review of the completed story implementation)_