# Story 1.5: admin-management

## Status
Approved

## Story
**As an** administrator,
**I want** to manage users, courses, and monitor learning progress through a comprehensive admin panel,
**so that** I can ensure the educational platform runs effectively and track teacher compliance

## Acceptance Criteria
1. Админ-панель доступна через отдельный роут с proper authentication
2. Управление пользователями: просмотр всех зарегистрированных учителей
3. Создание, редактирование и деактивация пользователей
4. Управление курсами: CRUD operations для курсов и уроков
5. Dashboard с общей статистикой (общее количество пользователей, завершивших курс)
6. Детальный прогресс каждого учителя (текущий урок, процент завершения)
7. Отчеты по обучению с фильтрацией и экспортом данных
8. Поиск и фильтрация пользователей по статусу обучения
9. Bulk actions для пользователей (массовые уведомления, reset прогресса)
10. Audit log для критических админ действий
11. Responsive design для управления с планшета/десктопа
12. Role-based access control (только администраторы)

## Tasks / Subtasks
- [ ] Создание админ роутинга и authentication (AC: 1, 12)
  - [ ] Создать admin layout с navigation
  - [ ] Реализовать admin role проверку
  - [ ] Настроить protected admin routes
  - [ ] Добавить admin middleware

- [ ] User Management интерфейс (AC: 2, 3, 8)
  - [ ] Создать таблицу пользователей с pagination
  - [ ] Реализовать user creation/edit forms
  - [ ] Добавить user deactivation функционал
  - [ ] Создать поиск и фильтры по статусу

- [ ] Course Management система (AC: 4)
  - [ ] Интерфейс управления курсами
  - [ ] CRUD operations для уроков
  - [ ] Course content editor
  - [ ] Course publishing workflow

- [ ] Progress Tracking Dashboard (AC: 5, 6, 7)
  - [ ] Общий dashboard с KPI metrics
  - [ ] Детальный прогресс по пользователю
  - [ ] Reports generation с фильтрами
  - [ ] Export functionality (CSV/PDF)

- [ ] Advanced admin features (AC: 9, 10)
  - [ ] Bulk user actions
  - [ ] Mass notification system
  - [ ] Audit logging система
  - [ ] Progress reset functionality

- [ ] Responsive admin UI (AC: 11)
  - [ ] Desktop-first admin design
  - [ ] Tablet adaptation
  - [ ] Admin data tables optimization
  - [ ] Mobile admin view (limited)

## Dev Notes

### Архитектурный контекст
- **Access Control:** Role-based с admin flag в User model
- **UI Framework:** Radix UI Tables + Admin-specific components
- **State Management:** React Query для admin data, Zustand для UI state
- **Data Export:** Client-side CSV generation, server-side PDF

### Database Extensions
Потребуются дополнительные поля:
- `User.role` - enum: 'teacher' | 'admin'
- `User.created_at`, `User.last_login` - для admin analytics
- `AuditLog` table - для tracking admin actions
- Indexes на UserCourseProgress для performance

### Admin UI Requirements
- Data-dense интерфейс (таблицы, charts)
- Bulk operations UI patterns
- Export/download functionality
- Real-time progress updates

### Technical Implementation
#### Admin Routes Structure:
- `/admin` - dashboard
- `/admin/users` - user management
- `/admin/courses` - course management  
- `/admin/reports` - progress reports

#### Key Components:
- AdminDataTable (sortable, filterable)
- ProgressChart (visual progress tracking)
- BulkActionToolbar
- ExportDialog

### Security Considerations
- Admin session timeout (shorter than regular users)
- Action confirmation dialogs для destructive operations
- Input sanitization для user data
- Rate limiting для bulk operations

### Dependencies
- `@tanstack/react-table` - data tables
- `recharts` - progress visualization
- `jsPDF` - PDF export
- `papaparse` - CSV handling

### Testing

#### Admin-Specific Testing Requirements
- Role-based access control: 100% coverage
- Data integrity в bulk operations: критично
- Export functionality: все форматы
- Admin UI responsiveness: desktop focus

#### Security Testing
- Unauthorized access attempts
- Privilege escalation scenarios  
- Admin session management
- Bulk operation limits

#### E2E Admin Flows:
```javascript
test('Complete admin user management flow', async ({ page }) => {
  // 1. Login as admin
  // 2. Navigate to users page
  // 3. Create new user
  // 4. View user progress
  // 5. Generate progress report
  // 6. Export data
});
```

## Change Log
| Date | Version | Description | Author |
|------|---------|-------------|---------|
| 2025-07-25 | 1.0 | Initial story creation for admin management | Sarah (PO) |

## Dev Agent Record
_(This section is populated by the development agent during implementation)_

### Agent Model Used
_(Заполняется dev-agent)_

### Debug Log References
_(Заполняется dev-agent)_

### Completion Notes List
_(Заполняется dev-agent)_

### File List
_(Заполняется dev-agent)_

## QA Results
_(Results from QA Agent QA review of the completed story implementation)_